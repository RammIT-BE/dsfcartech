import{j as e,m as P}from"./motion-vendor-b3aEScPj.js";import{r as o}from"./react-vendor-t_sxZuuz.js";import{s}from"./supabase-B6WgQy4M.js";import"./index-CZK8kUMJ.js";import"./index-ClCmVp7s.js";import"./i18n-vendor-DFJnsfug.js";function I(){const[d,j]=o.useState([]),[x,w]=o.useState(!0),[m,n]=o.useState(!1),[g,u]=o.useState(!1),[i,p]=o.useState([]),[N,c]=o.useState(!0);o.useEffect(()=>{y()},[]),o.useEffect(()=>{m&&h()},[m]);const y=async()=>{try{const{data:{session:t},error:r}=await s.auth.getSession();if(r){console.error("Auth error:",r),c(!1),n(!1),window.REACT_APP_NAVIGATE("/admin/login");return}if(!t){c(!1),n(!1),window.REACT_APP_NAVIGATE("/admin/login");return}const{data:{user:l},error:a}=await s.auth.getUser();if(a||!l){console.error("User verification error:",a),c(!1),n(!1),await s.auth.signOut(),window.REACT_APP_NAVIGATE("/admin/login");return}n(!0),c(!1)}catch(t){console.error("Unexpected auth error:",t),c(!1),n(!1),window.REACT_APP_NAVIGATE("/admin/login")}},v=async()=>{try{await s.auth.signOut()}catch(t){console.error("Logout error:",t)}window.REACT_APP_NAVIGATE("/admin/login")},h=async()=>{try{const{data:t,error:r}=await s.from("realisaties").select("*").order("created_at",{ascending:!1});if(r)throw r;j(t||[])}catch(t){console.error("Error fetching realisaties:",t),alert("Fout bij het laden van foto's. Controleer je internetverbinding.")}finally{w(!1)}},A=t=>{const r=Array.from(t.target.files||[]);p(r)},E=async()=>{if(i.length===0){alert("Selecteer minimaal één foto");return}u(!0);try{for(const t of i){const r=t.name.split(".").pop(),a=`${`${Date.now()}-${Math.random().toString(36).substring(7)}.${r}`}`,{error:f}=await s.storage.from("realisaties").upload(a,t,{cacheControl:"3600",upsert:!1});if(f)throw f;const{data:{publicUrl:_}}=s.storage.from("realisaties").getPublicUrl(a),{error:b}=await s.from("realisaties").insert([{image_url:_,title:`Foto ${Date.now()}`,description:"",service_type:"algemeen",car_model:"Onbekend"}]);if(b)throw b}alert(`${i.length} foto's succesvol toegevoegd!`),p([]),h()}catch(t){console.error("Error uploading images:",t),alert("Er is een fout opgetreden bij het uploaden")}finally{u(!1)}},k=async(t,r)=>{if(confirm("Weet je zeker dat je deze foto wilt verwijderen?"))try{if(r&&r.includes("supabase")){const a=r.split("/").pop();a&&await s.storage.from("realisaties").remove([a])}const{error:l}=await s.from("realisaties").delete().eq("id",t);if(l)throw l;h()}catch(l){console.error("Error deleting photo:",l),alert("Er is een fout opgetreden bij het verwijderen")}};return N||!m?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-cyan-500 border-t-transparent mb-4"}),e.jsx("p",{className:"text-white",children:"Authenticatie controleren..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900",children:[e.jsx("div",{className:"bg-black/50 backdrop-blur-xl border-b border-white/10 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl",children:e.jsx("i",{className:"ri-image-line text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Foto's Beheer"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Upload en beheer je foto's"})]})]}),e.jsxs("button",{onClick:v,className:"px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[e.jsx("i",{className:"ri-logout-box-line mr-2"}),"Uitloggen"]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8 bg-white/5 backdrop-blur-xl rounded-2xl border border-white/10 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Foto's Uploaden"}),e.jsxs("label",{className:"block mb-4",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:A,className:"hidden"}),e.jsxs("div",{className:"w-full px-4 py-8 bg-white/5 border-2 border-dashed border-white/20 hover:border-cyan-500/50 rounded-lg cursor-pointer transition-colors text-center",children:[e.jsx("i",{className:"ri-upload-cloud-line text-4xl text-cyan-400 mb-2"}),e.jsx("p",{className:"text-white font-medium mb-1",children:"Klik om foto's te selecteren"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Of sleep bestanden hierheen"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Meerdere foto's tegelijk mogelijk"})]})]}),i.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-300 mb-3",children:[i.length," foto's geselecteerd"]}),e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3 mb-4",children:i.map((t,r)=>e.jsx("div",{className:"relative group aspect-square",children:e.jsx("img",{src:URL.createObjectURL(t),alt:t.name,className:"w-full h-full object-cover rounded-lg"})},r))}),e.jsx("button",{onClick:E,disabled:g,className:"w-full px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-semibold rounded-lg hover:shadow-lg hover:shadow-cyan-500/50 transition-all duration-300 cursor-pointer whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:g?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Uploaden..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-upload-line mr-2"}),"Upload ",i.length," foto's"]})})]})]}),e.jsx("div",{className:"mb-6 text-white",children:e.jsxs("p",{className:"text-lg",children:["Totaal: ",e.jsx("span",{className:"font-bold text-cyan-400",children:d.length})," foto's"]})}),x?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-cyan-500 border-t-transparent"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Laden..."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:d.map(t=>e.jsxs(P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"relative group aspect-square bg-white/5 backdrop-blur-xl rounded-lg border border-white/10 overflow-hidden hover:border-cyan-500/50 transition-all duration-300",children:[e.jsx("img",{src:t.image_url,alt:`Foto ${t.id}`,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:e.jsxs("button",{onClick:()=>k(t.id,t.image_url),className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors cursor-pointer whitespace-nowrap",children:[e.jsx("i",{className:"ri-delete-bin-line mr-2"}),"Verwijderen"]})})]},t.id))}),d.length===0&&!x&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx("i",{className:"ri-image-line text-6xl text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"Nog geen foto's toegevoegd"})]})]})]})}export{I as default};
